<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta tags and Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery (if needed) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<header class="bg-primary text-white text-center py-4">
    <h1>Our Products</h1>
    <p>Check out our latest products!</p>
</header>

<main class="container my-5">
    <ul class="nav flex-column">
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Active</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item">
            <a class="nav-link disabled" aria-disabled="true">Disabled</a>
        </li>
    </ul>

    <div class="row">
        <section class="col-md-9">
            <div id="product-list" class="row">
            </div>
            <!-- Pagination -->
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center" id="pagination">
                </ul>
            </nav>
        </section>
    </div>
</main>
<footer></footer>

<script>
    $(document).ready(function () {
        let categoryId = 1;
        getCategoryProducts(categoryId, 0);

        function getCategoryProducts(categoryId, page) {
            $.ajax({
                url: `/api/categories/${categoryId}/products`,
                method: 'GET',
                data: {page: page, size: 3},
                success: function (response) {
                    if (response.code === 200) {
                        const data = response.data;
                        const products = data.products;

                        $('#product-list').empty();
                        $('#pagination').empty();

                        products.forEach(function (product) {
                            $('#product-list').append(`
                                    <div class="col-md-4 mb-4">
                                        <div class="card">
                                            <img src="${product.thumbnail || 'default-image.jpg'}" class="card-img-top"
                                            alt="${product.name}" style="width: 100%; height: 200px; object-fit: cover;">
                                            <div class="card-body">
                                                <h5 class="card-title">${product.name}</h5>
                                                <p class="card-text">${product.description}</p>
                                                <p class="card-text">${product.price} Ïõê</p>
                                            </div>
                                        </div>
                                    </div>
                                `);
                        });

                        // Build pagination buttons
                        for (let i = 0; i < data.totalPages; i++) {
                            $('#pagination').append(`
                                    <li class="page-item ${i === page ? 'active' : ''}">
                                        <a class="page-link" href="#" data-page="${i}">${i + 1}</a>
                                    </li>
                                `);
                        }
                    } else {
                        alert("Failed to load products.");
                    }
                },
                error: function () {
                    alert("An error occurred while loading products.");
                }
            });
        }

        $(document).on('click', '.list-group-item', function () {
            categoryId = $(this).data('category-id');
            getCategoryProducts(categoryId, 0);
        });

        $(document).on('click', '#pagination a', function (e) {
            e.preventDefault();
            let page = $(this).data('page');
            getCategoryProducts(categoryId, page);
        });
    });
</script>
</body>
</html>
